
[[tests]]
test_name = "add1"
source_file = "cpp/simple/add.cpp"
expected_output = "7"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "add2"
source_file = "cpp/simple/add.cpp"
expected_output = "7"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "add3"
source_file = "cpp/simple/add.cpp"
expected_output = "7"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "add4"
source_file = "cpp/simple/add.cpp"
expected_output = "7"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "class_polymorphism1"
source_file = "cpp/simple/class.cpp"
expected_output = """
12
5, 7
3, 6, 9
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "class_polymorphism2"
source_file = "cpp/simple/class.cpp"
expected_output = """
12
5, 7
3, 6, 9
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "class_polymorphism3"
source_file = "cpp/simple/class.cpp"
expected_output = """
12
5, 7
3, 6, 9
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "class_polymorphism4"
source_file = "cpp/simple/class.cpp"
expected_output = """
12
5, 7
3, 6, 9
"""
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "exception_handling1"
source_file = "cpp/simple/exceptions.cpp"
expected_output = """
Exception caught: Test exception
Exception caught: Test exception
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "exception_handling2"
source_file = "cpp/simple/exceptions.cpp"
expected_output = """
Exception caught: Test exception
Exception caught: Test exception
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "exception_handling3"
source_file = "cpp/simple/exceptions.cpp"
expected_output = """
Exception caught: Test exception
Exception caught: Test exception
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "exception_handling4"
source_file = "cpp/simple/exceptions.cpp"
expected_output = """
Exception caught: Test exception
Exception caught: Test exception
"""
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "fact1"
source_file = "cpp/simple/fact.cpp"
expected_output = """
3628800
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "fact2"
source_file = "cpp/simple/fact.cpp"
expected_output = """
3628800
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "fact3"
source_file = "cpp/simple/fact.cpp"
expected_output = """
3628800
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "fact4"
source_file = "cpp/simple/fact.cpp"
expected_output = """
3628800
"""
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "func1"
source_file = "cpp/simple/func.cpp"
expected_output = """
Function f called (g incremented to 1)
Final value of g: 1
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "func2"
source_file = "cpp/simple/func.cpp"
expected_output = """
Function f called (g incremented to 1)
Final value of g: 1
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "func3"
source_file = "cpp/simple/func.cpp"
expected_output = """
Function f called (g incremented to 1)
Final value of g: 1
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "func4"
source_file = "cpp/simple/func.cpp"
expected_output = """
Function f called (g incremented to 1)
Final value of g: 1
"""
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "mul1"
source_file = "cpp/simple/mul.cpp"
expected_output = """
42
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "mul2"
source_file = "cpp/simple/mul.cpp"
expected_output = """
42
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "mul3"
source_file = "cpp/simple/mul.cpp"
expected_output = """
42
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "mul4"
source_file = "cpp/simple/mul.cpp"
expected_output = """
42
"""
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "template1"
source_file = "cpp/simple/template.cpp"
expected_output = """
Result: 42
Result: 15
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "template2"
source_file = "cpp/simple/template.cpp"
expected_output = """
Result: 42
Result: 15
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "template3"
source_file = "cpp/simple/template.cpp"
expected_output = """
Result: 42
Result: 15
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "template4"
source_file = "cpp/simple/template.cpp"
expected_output = """
Result: 42
Result: 15
"""
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "ptrsSharedUnique1"
source_file = "cpp/simple/ptr.cpp"
expected_output = """
Value pointed by p1: 42, Value pointed by p2: 42
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "ptrsSharedUnique2"
source_file = "cpp/simple/ptr.cpp"
expected_output = """
Value pointed by p1: 42, Value pointed by p2: 42
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "ptrsSharedUnique3"
source_file = "cpp/simple/ptr.cpp"
expected_output = """
Value pointed by p1: 42, Value pointed by p2: 42
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "ptrsSharedUnique4"
source_file = "cpp/simple/ptr.cpp"
expected_output = """
Value pointed by p1: 42, Value pointed by p2: 42
"""
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "heap1"
source_file = "cpp/simple/heap.cpp"
expected_output = """
Value: 10
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "heap2"
source_file = "cpp/simple/heap.cpp"
expected_output = """
Value: 10
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "heap3"
source_file = "cpp/simple/heap.cpp"
expected_output = """
Value: 10
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "heap4"
source_file = "cpp/simple/heap.cpp"
expected_output = """
Value: 10
"""
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "raii_filehandler1"
source_file = "cpp/simple/file_handler.cpp"
expected_output = """
Handler created
File closed
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "raii_filehandler2"
source_file = "cpp/simple/file_handler.cpp"
expected_output = """
Handler created
File closed
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "raii_filehandler3"
source_file = "cpp/simple/file_handler.cpp"
expected_output = """
Handler created
File closed
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "raii_filehandler4"
source_file = "cpp/simple/file_handler.cpp"
expected_output = """
Handler created
File closed
"""
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "inline_constexpr1"
source_file = "cpp/simple/inline_constexpr.cpp"
aspis_options = "--eddi --cfcss"
expected_output = """
9
16
5
"""

[[tests]]
test_name = "inline_constexpr2"
source_file = "cpp/simple/inline_constexpr.cpp"
aspis_options = "--seddi --rasm"
expected_output = """
9
16
5
"""

[[tests]]
test_name = "inline_constexpr3"
source_file = "cpp/simple/inline_constexpr.cpp"
aspis_options = "--fdsc --rasm"
expected_output = """
9
16
5
"""

[[tests]]
test_name = "inline_constexpr4"
source_file = "cpp/simple/inline_constexpr.cpp"
aspis_options = "--eddi --no-cfc"
expected_output = """
9
16
5
"""

[[tests]]
test_name = "lambda_captures1"
source_file = "cpp/simple/lambda_captures.cpp"
aspis_options = "--eddi --cfcss"
expected_output = """
x incremented by 5
Value pointed by p: 11
"""

[[tests]]
test_name = "lambda_captures2"
source_file = "cpp/simple/lambda_captures.cpp"
aspis_options = "--seddi --rasm"
expected_output = """
x incremented by 5
Value pointed by p: 11
"""

[[tests]]
test_name = "lambda_captures3"
source_file = "cpp/simple/lambda_captures.cpp"
aspis_options = "--fdsc --rasm"
expected_output = """
x incremented by 5
Value pointed by p: 11
"""

[[tests]]
test_name = "lambda_captures4"
source_file = "cpp/simple/lambda_captures.cpp"
aspis_options = "--eddi --no-cfc"
expected_output = """
x incremented by 5
Value pointed by p: 11
"""

[[tests]]
test_name = "volatile_memory_order1"
source_file = "cpp/simple/volatile_memory_order.cpp"
aspis_options = "--eddi --cfcss"
expected_output = """
42
"""

[[tests]]
test_name = "volatile_memory_order2"
source_file = "cpp/simple/volatile_memory_order.cpp"
aspis_options = "--seddi --rasm"
expected_output = """
42
"""

[[tests]]
test_name = "volatile_memory_order3"
source_file = "cpp/simple/volatile_memory_order.cpp"
aspis_options = "--fdsc --rasm"
expected_output = """
42
"""

[[tests]]
test_name = "volatile_memory_order4"
source_file = "cpp/simple/volatile_memory_order.cpp"
aspis_options = "--eddi --no-cfc"
expected_output = """
42
"""

[[tests]]
test_name = "stl_containers_advanced1"
source_file = "cpp/simple/stl_containers_advanced.cpp"
aspis_options = "--eddi --cfcss"
expected_output = """
0 1 2 3 4 
"""

[[tests]]
test_name = "stl_containers_advanced2"
source_file = "cpp/simple/stl_containers_advanced.cpp"
aspis_options = "--seddi --rasm"
expected_output = """
0 1 2 3 4 
"""

[[tests]]
test_name = "stl_containers_advanced3"
source_file = "cpp/simple/stl_containers_advanced.cpp"
aspis_options = "--fdsc --rasm"
expected_output = """
0 1 2 3 4 
"""

[[tests]]
test_name = "stl_containers_advanced4"
source_file = "cpp/simple/stl_containers_advanced.cpp"
aspis_options = "--eddi --no-cfc"
expected_output = """
0 1 2 3 4 
"""

# [[tests]]
# test_name = "threads1"
# source_file = "cpp/simple/threads.cpp"
# aspis_options = "--eddi --cfcss"
# expected_output = """
# 4000
# """
# 
# [[tests]]
# test_name = "threads2"
# source_file = "cpp/simple/threads.cpp"
# aspis_options = "--seddi --rasm"
# expected_output = """
# 4000
# """
# 
# [[tests]]
# test_name = "threads3"
# source_file = "cpp/simple/threads.cpp"
# aspis_options = "--fdsc --rasm"
# expected_output = """
# 4000
# """
# 
# [[tests]]
# test_name = "threads4"
# source_file = "cpp/simple/threads.cpp"
# aspis_options = "--eddi --no-cfc"
# expected_output = """
# 4000
# """

[[tests]]
test_name = "function_pointer_v0"
source_file = "c/control_flow/function_pointer.c"
expected_output = "42"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "function_pointer_v1"
source_file = "c/control_flow/function_pointer.c"
expected_output = "42"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "function_pointer_v2"
source_file = "c/control_flow/function_pointer.c"
expected_output = "42"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "function_pointer_v3"
source_file = "c/control_flow/function_pointer.c"
expected_output = "42"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "loop_exit_v0"
source_file = "c/control_flow/loop_exit.c"
expected_output = "2"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "loop_exit_v1"
source_file = "c/control_flow/loop_exit.c"
expected_output = "2"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "loop_exit_v2"
source_file = "c/control_flow/loop_exit.c"
expected_output = "2"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "loop_exit_v3"
source_file = "c/control_flow/loop_exit.c"
expected_output = "2"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "nested-branch_v0"
source_file = "c/control_flow/nested-branch.c"
expected_output = "6"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "nested-branch_v1"
source_file = "c/control_flow/nested-branch.c"
expected_output = "6"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "nested-branch_v2"
source_file = "c/control_flow/nested-branch.c"
expected_output = "6"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "nested-branch_v3"
source_file = "c/control_flow/nested-branch.c"
expected_output = "6"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "simple-branch_v0"
source_file = "c/control_flow/simple-branch.c"
expected_output = "OK"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "simple-branch_v1"
source_file = "c/control_flow/simple-branch.c"
expected_output = "OK"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "simple-branch_v2"
source_file = "c/control_flow/simple-branch.c"
expected_output = "OK"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "simple-branch_v3"
source_file = "c/control_flow/simple-branch.c"
expected_output = "OK"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "switch-case_v0"
source_file = "c/control_flow/switch-case.c"
expected_output = "300"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "switch-case_v1"
source_file = "c/control_flow/switch-case.c"
expected_output = "300"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "switch-case_v2"
source_file = "c/control_flow/switch-case.c"
expected_output = "300"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "switch-case_v3"
source_file = "c/control_flow/switch-case.c"
expected_output = "300"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "data_dep_branches_v0"
source_file = "c/data_duplication_integrity/data_dep_branches.c"
expected_output = "7"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "data_dep_branches_v1"
source_file = "c/data_duplication_integrity/data_dep_branches.c"
expected_output = "7"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "data_dep_branches_v2"
source_file = "c/data_duplication_integrity/data_dep_branches.c"
expected_output = "7"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "data_dep_branches_v3"
source_file = "c/data_duplication_integrity/data_dep_branches.c"
expected_output = "7"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "global_var_across_functions_v0"
source_file = "c/data_duplication_integrity/global_var_across_functions.c"
expected_output = "2"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "global_var_across_functions_v1"
source_file = "c/data_duplication_integrity/global_var_across_functions.c"
expected_output = "2"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "global_var_across_functions_v2"
source_file = "c/data_duplication_integrity/global_var_across_functions.c"
expected_output = "2"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "global_var_across_functions_v3"
source_file = "c/data_duplication_integrity/global_var_across_functions.c"
expected_output = "2"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "misc_data_dup_v0"
source_file = "c/data_duplication_integrity/misc_data_dup.c"
expected_output = "OK"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "misc_data_dup_v1"
source_file = "c/data_duplication_integrity/misc_data_dup.c"
expected_output = "OK"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "misc_data_dup_v2"
source_file = "c/data_duplication_integrity/misc_data_dup.c"
expected_output = "OK"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "misc_data_dup_v3"
source_file = "c/data_duplication_integrity/misc_data_dup.c"
expected_output = "OK"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "volatile_io_v0"
source_file = "c/data_duplication_integrity/volatile_io.c"
expected_output = "42"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "volatile_io_v1"
source_file = "c/data_duplication_integrity/volatile_io.c"
expected_output = "42"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "volatile_io_v2"
source_file = "c/data_duplication_integrity/volatile_io.c"
expected_output = "42"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "volatile_io_v3"
source_file = "c/data_duplication_integrity/volatile_io.c"
expected_output = "42"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "arit_pipeline_v0"
source_file = "c/misc_math/arit_pipeline.c"
expected_output = "3"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "arit_pipeline_v1"
source_file = "c/misc_math/arit_pipeline.c"
expected_output = "3"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "arit_pipeline_v2"
source_file = "c/misc_math/arit_pipeline.c"
expected_output = "3"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "arit_pipeline_v3"
source_file = "c/misc_math/arit_pipeline.c"
expected_output = "3"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "mixed_ops_v0"
source_file = "c/misc_math/mixed_ops.c"
expected_output = "14.5"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "mixed_ops_v1"
source_file = "c/misc_math/mixed_ops.c"
expected_output = "14.5"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "mixed_ops_v2"
source_file = "c/misc_math/mixed_ops.c"
expected_output = "14.5"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "mixed_ops_v3"
source_file = "c/misc_math/mixed_ops.c"
expected_output = "14.5"
aspis_options = "--eddi --no-cfc"

[[tests]]
test_name = "xor_cypher_v0"
source_file = "c/misc_math/xor_cypher.c"
expected_output = "SUCCESS"
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "xor_cypher_v1"
source_file = "c/misc_math/xor_cypher.c"
expected_output = "SUCCESS"
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "xor_cypher_v2"
source_file = "c/misc_math/xor_cypher.c"
expected_output = "SUCCESS"
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "xor_cypher_v3"
source_file = "c/misc_math/xor_cypher.c"
expected_output = "SUCCESS"
aspis_options = "--eddi --no-cfc"

# --------------------------------------------------------------------------------------------
# The following tests have been developed for the project: 'Harden a C Application with ASPIS'
# All the codes tested here can be found in the repository: testing/tests/c/extended
# --------------------------------------------------------------------------------------------

# ---------------------------------------------------------------------------
# 1 - struct_player
# ---------------------------------------------------------------------------

[[tests]]
test_name = "struct_player_v0"
source_file = "c/extended/struct_player.c"
expected_output = """
SCORE: 95
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "struct_player_v1"
source_file = "c/extended/struct_player.c"
expected_output = """
SCORE: 95
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "struct_player_v2"
source_file = "c/extended/struct_player.c"
expected_output = """
SCORE: 95
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "struct_player_v3"
source_file = "c/extended/struct_player.c"
expected_output = """
SCORE: 95
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 2 - array2d_sum
# ---------------------------------------------------------------------------

[[tests]]
test_name = "array2d_sum_v0"
source_file = "c/extended/array2d_sum.c"
expected_output = """
SUM: 45
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "array2d_sum_v1"
source_file = "c/extended/array2d_sum.c"
expected_output = """
SUM: 45
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "array2d_sum_v2"
source_file = "c/extended/array2d_sum.c"
expected_output = """
SUM: 45
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "array2d_sum_v3"
source_file = "c/extended/array2d_sum.c"
expected_output = """
SUM: 45
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 3 - ptr_to_ptr
# ---------------------------------------------------------------------------

[[tests]]
test_name = "ptr_to_ptr_v0"
source_file = "c/extended/ptr_to_ptr.c"
expected_output = """
VAL: 12
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "ptr_to_ptr_v1"
source_file = "c/extended/ptr_to_ptr.c"
expected_output = """
VAL: 12
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "ptr_to_ptr_v2"
source_file = "c/extended/ptr_to_ptr.c"
expected_output = """
VAL: 12
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "ptr_to_ptr_v3"
source_file = "c/extended/ptr_to_ptr.c"
expected_output = """
VAL: 12
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 4 - recursion_factorial
# ---------------------------------------------------------------------------

[[tests]]
test_name = "recursion_factorial_v0"
source_file = "c/extended/recursion_factorial.c"
expected_output = """
FACT: 120
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "recursion_factorial_v1"
source_file = "c/extended/recursion_factorial.c"
expected_output = """
FACT: 120
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "recursion_factorial_v2"
source_file = "c/extended/recursion_factorial.c"
expected_output = """
FACT: 120
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "recursion_factorial_v3"
source_file = "c/extended/recursion_factorial.c"
expected_output = """
FACT: 120
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 5 - heap_dynamic
# ---------------------------------------------------------------------------

[[tests]]
test_name = "heap_dynamic_v0"
source_file = "c/extended/heap_dynamic.c"
expected_output = """
SUM: 30
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "heap_dynamic_v1"
source_file = "c/extended/heap_dynamic.c"
expected_output = """
SUM: 30
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "heap_dynamic_v2"
source_file = "c/extended/heap_dynamic.c"
expected_output = """
SUM: 30
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "heap_dynamic_v3"
source_file = "c/extended/heap_dynamic.c"
expected_output = """
SUM: 30
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 6 - funptr_static_map
# ---------------------------------------------------------------------------

[[tests]]
test_name = "funptr_static_map_v0"
source_file = "c/extended/funptr_static_map.c"
expected_output = """
checksum=2113704757
sentinels=-4 -3 10 11
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "funptr_static_map_v1"
source_file = "c/extended/funptr_static_map.c"
expected_output = """
checksum=2113704757
sentinels=-4 -3 10 11
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "funptr_static_map_v2"
source_file = "c/extended/funptr_static_map.c"
expected_output = """
checksum=2113704757
sentinels=-4 -3 10 11
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "funptr_static_map_v3"
source_file = "c/extended/funptr_static_map.c"
expected_output = """
checksum=2113704757
sentinels=-4 -3 10 11
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 7 - funptr_heap_minimal
# ---------------------------------------------------------------------------

[[tests]]
test_name = "funptr_heap_minimal_v0"
source_file = "c/extended/funptr_heap_minimal.c"
expected_output = """
checksum=1649235461
sentinels=-2 -88 62 112
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "funptr_heap_minimal_v1"
source_file = "c/extended/funptr_heap_minimal.c"
expected_output = """
checksum=1649235461
sentinels=-2 -88 62 112
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "funptr_heap_minimal_v2"
source_file = "c/extended/funptr_heap_minimal.c"
expected_output = """
checksum=1649235461
sentinels=-2 -88 62 112
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "funptr_heap_minimal_v3"
source_file = "c/extended/funptr_heap_minimal.c"
expected_output = """
checksum=1649235461
sentinels=-2 -88 62 112
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 8 - funptr_heap_alias
# ---------------------------------------------------------------------------

[[tests]]
test_name = "funptr_heap_alias_v0"
source_file = "c/extended/funptr_heap_alias.c"
expected_output = """
checksum=1158918729
sentinels=1 3 26 30
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "funptr_heap_alias_v1"
source_file = "c/extended/funptr_heap_alias.c"
expected_output = """
checksum=1158918729
sentinels=1 3 26 30
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "funptr_heap_alias_v2"
source_file = "c/extended/funptr_heap_alias.c"
expected_output = """
checksum=1158918729
sentinels=1 3 26 30
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "funptr_heap_alias_v3"
source_file = "c/extended/funptr_heap_alias.c"
expected_output = """
checksum=1158918729
sentinels=1 3 26 30
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 9 - funptr_table_runtime
# ---------------------------------------------------------------------------

[[tests]]
test_name = "funptr_table_runtime_v0"
source_file = "c/extended/funptr_table_runtime.c"
expected_output = """
checksum=3171147141
sentinels=1 2 8 9
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "funptr_table_runtime_v1"
source_file = "c/extended/funptr_table_runtime.c"
expected_output = """
checksum=3171147141
sentinels=1 2 8 9
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "funptr_table_runtime_v2"
source_file = "c/extended/funptr_table_runtime.c"
expected_output = """
checksum=3171147141
sentinels=1 2 8 9
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "funptr_table_runtime_v3"
source_file = "c/extended/funptr_table_runtime.c"
expected_output = """
checksum=3171147141
sentinels=1 2 8 9
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 10 - funptr_factory_return
# ---------------------------------------------------------------------------

[[tests]]
test_name = "funptr_factory_return_v0"
source_file = "c/extended/funptr_factory_return.c"
expected_output = """
checksum=2249736000
sentinels=-3 4 67 74
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "funptr_factory_return_v1"
source_file = "c/extended/funptr_factory_return.c"
expected_output = """
checksum=2249736000
sentinels=-3 4 67 74
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "funptr_factory_return_v2"
source_file = "c/extended/funptr_factory_return.c"
expected_output = """
checksum=2249736000
sentinels=-3 4 67 74
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "funptr_factory_return_v3"
source_file = "c/extended/funptr_factory_return.c"
expected_output = """
checksum=2249736000
sentinels=-3 4 67 74
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 11 - funptr_qsort_callback
# NOTE: data-flow protection crashes at runtime (segfault) when callback is
# invoked from external uninstrumented library code (qsort).
# -> control-flow-only variants are stable.
# ---------------------------------------------------------------------------

[[tests]]
test_name = "funptr_qsort_callback_v0"
source_file = "c/extended/funptr_qsort_callback.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
"""
aspis_options = "--no-dup --cfcss"

[[tests]]
test_name = "funptr_qsort_callback_v1"
source_file = "c/extended/funptr_qsort_callback.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
"""
aspis_options = "--no-dup --rasm"

# ---------------------------------------------------------------------------
# 11b - funptr_qsort_callback_mitigation
# NOTE: callback annotated exclude -> stable even with data-flow protection.
# ---------------------------------------------------------------------------

[[tests]]
test_name = "funptr_qsort_callback_mitigation_v0"
source_file = "c/extended/funptr_qsort_callback_mitigation.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "funptr_qsort_callback_mitigation_v1"
source_file = "c/extended/funptr_qsort_callback_mitigation.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "funptr_qsort_callback_mitigation_v2"
source_file = "c/extended/funptr_qsort_callback_mitigation.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "funptr_qsort_callback_mitigation_v3"
source_file = "c/extended/funptr_qsort_callback_mitigation.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 12 - funptr_bsearch_callback
# NOTE: same “external callback” boundary observed with bsearch.
# Only control-flow-only variants are stable.
# ---------------------------------------------------------------------------

[[tests]]
test_name = "funptr_bsearch_callback_v0"
source_file = "c/extended/funptr_bsearch_callback.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
found=6 idx=6
"""
aspis_options = "--no-dup --cfcss"

[[tests]]
test_name = "funptr_bsearch_callback_v1"
source_file = "c/extended/funptr_bsearch_callback.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
found=6 idx=6
"""
aspis_options = "--no-dup --rasm"

# ---------------------------------------------------------------------------
# 12b - funptr_bsearch_callback_mitigation
# NOTE: callback annotated exclude -> stable even with data-flow protection.
# ---------------------------------------------------------------------------

[[tests]]
test_name = "funptr_bsearch_callback_mitigation_v0"
source_file = "c/extended/funptr_bsearch_callback_mitigation.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
found=6 idx=6
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "funptr_bsearch_callback_mitigation_v1"
source_file = "c/extended/funptr_bsearch_callback_mitigation.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
found=6 idx=6
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "funptr_bsearch_callback_mitigation_v2"
source_file = "c/extended/funptr_bsearch_callback_mitigation.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
found=6 idx=6
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "funptr_bsearch_callback_mitigation_v3"
source_file = "c/extended/funptr_bsearch_callback_mitigation.c"
expected_output = """
checksum=797261938
sentinels=0 1 8 9
found=6 idx=6
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 13 - pthread_entry_callback
# NOTE: entry-point invoked by external runtime (libpthread) -> segfault
# ---------------------------------------------------------------------------
# 
# [[tests]]
# test_name = "pthread_entry_callback_v0"
# source_file = "c/extended/pthread_entry_callback.c"
# expected_output = "EXPECTED_FAIL: segfault at runtime (external entry-point + data-flow)"
# aspis_options = "--eddi --cfcss"
# 
# [[tests]]
# test_name = "pthread_entry_callback_v1"
# source_file = "c/extended/pthread_entry_callback.c"
# expected_output = "EXPECTED_FAIL: segfault at runtime (external entry-point + data-flow)"
# aspis_options = "--seddi --rasm"
# 
# [[tests]]
# test_name = "pthread_entry_callback_v2"
# source_file = "c/extended/pthread_entry_callback.c"
# expected_output = "EXPECTED_FAIL: segfault at runtime (external entry-point + data-flow)"
# aspis_options = "--fdsc --rasm"
# 
# [[tests]]
# test_name = "pthread_entry_callback_v3"
# source_file = "c/extended/pthread_entry_callback.c"
# expected_output = "EXPECTED_FAIL: segfault at runtime (external entry-point + data-flow)"
# aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 13b - pthread_entry_callback_mitigation
# ---------------------------------------------------------------------------

[[tests]]
test_name = "pthread_entry_callback_mitigation_v0"
source_file = "c/extended/pthread_entry_callback_mitigation.c"
expected_output = """
checksum=260243592
sentinels=1 3 13 15
"""
aspis_options = "--eddi --cfcss -pthread"

[[tests]]
test_name = "pthread_entry_callback_mitigation_v1"
source_file = "c/extended/pthread_entry_callback_mitigation.c"
expected_output = """
checksum=260243592
sentinels=1 3 13 15
"""
aspis_options = "--seddi --rasm -pthread"

[[tests]]
test_name = "pthread_entry_callback_mitigation_v2"
source_file = "c/extended/pthread_entry_callback_mitigation.c"
expected_output = """
checksum=260243592
sentinels=1 3 13 15
"""
aspis_options = "--fdsc --rasm -pthread"

[[tests]]
test_name = "pthread_entry_callback_mitigation_v3"
source_file = "c/extended/pthread_entry_callback_mitigation.c"
expected_output = """
checksum=260243592
sentinels=1 3 13 15
"""
aspis_options = "--eddi --no-cfc -pthread"

# ---------------------------------------------------------------------------
# 14 - varargs_sum
# NOTE: hardening fails at compile-time (invalid LLVM IR) with data-flow passes.
# ---------------------------------------------------------------------------
# 
# [[tests]]
# test_name = "varargs_sum_v0"
# source_file = "c/extended/varargs_sum.c"
# expected_output = "EXPECTED_FAIL: compile-time (LLVM verifier error on varargs signature)"
# aspis_options = "--eddi --cfcss"
# 
# [[tests]]
# test_name = "varargs_sum_v1"
# source_file = "c/extended/varargs_sum.c"
# expected_output = "EXPECTED_FAIL: compile-time (LLVM verifier error on varargs signature)"
# aspis_options = "--seddi --rasm"
# 
# [[tests]]
# test_name = "varargs_sum_v2"
# source_file = "c/extended/varargs_sum.c"
# expected_output = "EXPECTED_FAIL: compile-time (LLVM verifier error on varargs signature)"
# aspis_options = "--fdsc --rasm"
# 
# [[tests]]
# test_name = "varargs_sum_v3"
# source_file = "c/extended/varargs_sum.c"
# expected_output = "EXPECTED_FAIL: compile-time (LLVM verifier error on varargs signature)"
# aspis_options = "--eddi --no-cfc"
# 
# ---------------------------------------------------------------------------
# 15 - bitfield_packet
# ---------------------------------------------------------------------------

[[tests]]
test_name = "bitfield_packet_v0"
source_file = "c/extended/bitfield_packet.c"
expected_output = """
checksum=3739283678
sentinels=0 22 1215 1430
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "bitfield_packet_v1"
source_file = "c/extended/bitfield_packet.c"
expected_output = """
checksum=3739283678
sentinels=0 22 1215 1430
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "bitfield_packet_v2"
source_file = "c/extended/bitfield_packet.c"
expected_output = """
checksum=3739283678
sentinels=0 22 1215 1430
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "bitfield_packet_v3"
source_file = "c/extended/bitfield_packet.c"
expected_output = """
checksum=3739283678
sentinels=0 22 1215 1430
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 16 - memcpy_struct_bulk
# ---------------------------------------------------------------------------

[[tests]]
test_name = "memcpy_struct_bulk_v0"
source_file = "c/extended/memcpy_struct_bulk.c"
expected_output = """
checksum=1467585440
sentinels=3 10 89 81
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "memcpy_struct_bulk_v1"
source_file = "c/extended/memcpy_struct_bulk.c"
expected_output = """
checksum=1467585440
sentinels=3 10 89 81
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "memcpy_struct_bulk_v2"
source_file = "c/extended/memcpy_struct_bulk.c"
expected_output = """
checksum=1467585440
sentinels=3 10 89 81
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "memcpy_struct_bulk_v3"
source_file = "c/extended/memcpy_struct_bulk.c"
expected_output = """
checksum=1467585440
sentinels=3 10 89 81
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 17 - signal_flag_handler
# ---------------------------------------------------------------------------

[[tests]]
test_name = "signal_flag_handler_v0"
source_file = "c/extended/signal_flag_handler.c"
expected_output = """
checksum=839387125
sentinels=93 81 89 93
got_signal=1
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "signal_flag_handler_v1"
source_file = "c/extended/signal_flag_handler.c"
expected_output = """
checksum=839387125
sentinels=93 81 89 93
got_signal=1
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "signal_flag_handler_v2"
source_file = "c/extended/signal_flag_handler.c"
expected_output = """
checksum=839387125
sentinels=93 81 89 93
got_signal=1
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "signal_flag_handler_v3"
source_file = "c/extended/signal_flag_handler.c"
expected_output = """
checksum=839387125
sentinels=93 81 89 93
got_signal=1
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 18 - signal_loop_break_volatile
# ---------------------------------------------------------------------------

[[tests]]
test_name = "signal_loop_break_volatile_v0"
source_file = "c/extended/signal_loop_break_volatile.c"
expected_output = """
checksum=2911428346
sentinels=1592477752 4188842368 145946737 927160124
stop_flag=1 iters=201 tick=579148290
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "signal_loop_break_volatile_v1"
source_file = "c/extended/signal_loop_break_volatile.c"
expected_output = """
checksum=2911428346
sentinels=1592477752 4188842368 145946737 927160124
stop_flag=1 iters=201 tick=579148290
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "signal_loop_break_volatile_v2"
source_file = "c/extended/signal_loop_break_volatile.c"
expected_output = """
checksum=2911428346
sentinels=1592477752 4188842368 145946737 927160124
stop_flag=1 iters=201 tick=579148290
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "signal_loop_break_volatile_v3"
source_file = "c/extended/signal_loop_break_volatile.c"
expected_output = """
checksum=2911428346
sentinels=1592477752 4188842368 145946737 927160124
stop_flag=1 iters=201 tick=579148290
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 19 - atomic_fetch_add
# ---------------------------------------------------------------------------

[[tests]]
test_name = "atomic_fetch_add_v0"
source_file = "c/extended/atomic_fetch_add.c"
expected_output = """
checksum=2887388389
sentinels=2931447553 1951191220 2572826555 1131159742
ctr=10000
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "atomic_fetch_add_v1"
source_file = "c/extended/atomic_fetch_add.c"
expected_output = """
checksum=2887388389
sentinels=2931447553 1951191220 2572826555 1131159742
ctr=10000
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "atomic_fetch_add_v2"
source_file = "c/extended/atomic_fetch_add.c"
expected_output = """
checksum=2887388389
sentinels=2931447553 1951191220 2572826555 1131159742
ctr=10000
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "atomic_fetch_add_v3"
source_file = "c/extended/atomic_fetch_add.c"
expected_output = """
checksum=2887388389
sentinels=2931447553 1951191220 2572826555 1131159742
ctr=10000
"""
aspis_options = "--eddi --no-cfc"

# ---------------------------------------------------------------------------
# 20 - mega_ok_domain
# ---------------------------------------------------------------------------

[[tests]]
test_name = "mega_ok_domain_v0"
source_file = "c/extended/mega_ok_domain.c"
expected_output = """
checksum=3577851111
sentinels=1 8 2654436132 2654436026
facts=3628800 s2d=325 diag=15->25 got_signal=1 iters=201
"""
aspis_options = "--eddi --cfcss"

[[tests]]
test_name = "mega_ok_domain_v1"
source_file = "c/extended/mega_ok_domain.c"
expected_output = """
checksum=3577851111
sentinels=1 8 2654436132 2654436026
facts=3628800 s2d=325 diag=15->25 got_signal=1 iters=201
"""
aspis_options = "--seddi --rasm"

[[tests]]
test_name = "mega_ok_domain_v2"
source_file = "c/extended/mega_ok_domain.c"
expected_output = """
checksum=3577851111
sentinels=1 8 2654436132 2654436026
facts=3628800 s2d=325 diag=15->25 got_signal=1 iters=201
"""
aspis_options = "--fdsc --rasm"

[[tests]]
test_name = "mega_ok_domain_v3"
source_file = "c/extended/mega_ok_domain.c"
expected_output = """
checksum=3577851111
sentinels=1 8 2654436132 2654436026
facts=3628800 s2d=325 diag=15->25 got_signal=1 iters=201
"""
aspis_options = "--eddi --no-cfc"
